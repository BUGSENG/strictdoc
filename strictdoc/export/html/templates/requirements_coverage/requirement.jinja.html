 {%- set requirement_file_links = traceability_index.get_requirement_file_links(requirement) %}

<article class="requirement"
{%- if requirement.status %}
data-status='{{ requirement.status.lower() }}'
{%- endif %}
{%- if requirement.uid %}
data-uid='{{ requirement.uid }}'
{%- endif %}>

  <section>

    {%- if anchor is defined -%}
    <div data-role='anchor' id="{{ anchor }}"></div>
    {%- endif -%}

    <div
      class="section-title"
      data-level="{{ requirement.context.title_number_string }}"
    >{{ requirement.uid if requirement.uid else '[no UID]' }}</div>
    <div>{{ requirement.title if requirement.title else (requirement.uid if requirement.uid else '') }}</div>

  </section>
</article>

{%- if requirement_file_links %}
<details class="requirement_files" open>
  <summary>files</summary>

  <ul class="requirement_link">
  {%- for link, opt_ranges in requirement_file_links %}
    {%- if opt_ranges -%}
      {%- for range in opt_ranges %}
        <li>
          <a class="" href="{{ link_renderer.render_source_file_link(requirement, link) }}#{{ requirement.uid }}#{{ range.ng_source_line_begin }}#{{ range.ng_source_line_end }}">
            <b>[ {{ range.ng_source_line_begin }}-{{ range.ng_source_line_end }} ]</b> {{ link }}
          </a>
        </li>
      {%- endfor -%}
    {%- else -%}
      <li>
        <a class="" href="{{ link_renderer.render_source_file_link(requirement, link) }}#{{ requirement.uid }}">
          {{ link }}
        </a>
      </li>
    {%- endif -%}
  {%- endfor -%}
  </ul>

</details>
{%- endif %}
