{% set template_type = 'Table' %}

{% extends "base.jinja.html" %}

{% block head_scripts %}
  <script type="text/javascript" src="{{root_path}}/_static/toc.js"></script>
  {%- if config.enable_mathjax -%}
  <script id="MathJax-script" async src="{{root_path}}/_static/mathjax/tex-mml-chtml.js"></script>
  {%- endif -%}
  {{ super() }}
{% endblock head_scripts %}
{% block title %}{{document.name}} - {{ template_type }}{% endblock %}
{% block viewtype %}table-view{% endblock %}

{% block layout_nav %}
  {% include "_shared/doc_nav.jinja.html" %}
{% endblock layout_nav %}

{% block aside_header_content %}
  {% include "_shared/aside_header.jinja.html" %}
{% endblock aside_header_content %}

{% block aside_content %}
  {% include "_shared/toc.jinja.html" %}
{% endblock aside_content %}

{% block header_content %}
  <p>{{document.name}} <span class="document-view-type">{{ template_type }}</span></p>
{% endblock header_content %}

{% block content %}

      {% include "_shared/tags.jinja.html" %}

    {%- if document.config.has_meta() -%}
      <div class="content_meta">
      <h1>{{document.title}}</h1>
        <table style="width:auto;">
          {%- if document.config.uid -%}
          <tr>
            <th>
              UID:
            </th>
            <td>
              {{document.config.uid}}
            </td>
          </tr>
          {%- endif -%}
          {%- if document.config.version -%}
          <tr>
            <th>
              VERSION:
            </th>
            <td>
              {{document.config.version}}
            </td>
          </tr>
          {%- endif -%}
        </table>
      </div>
    {%- endif -%}

<div class="content_meta">
<table class="table-content">

  <thead>
    <tr>
      <th>Type</th>
      {# if exists #}
      <th>UID</th>
      {# endif #}
      <th>Title</th>
      <th>Statement</th>
      <th>Rationale</th>
      <th>Comment</th>
    </tr>
  </thead>

  {%- for section_or_requirement in document_iterator.all_content() %}
  {%- if section_or_requirement.is_composite_requirement %}
    {%- set requirement = section_or_requirement %}
  <tr>
   <th>Composite requirement</th>
    <td>{%- if requirement.uid %}{{ requirement.uid }}{%- endif -%}</td>
    <td class="td-title">{%- if requirement.title %}{{ requirement.title }}{%- endif -%}</td>
    <td class="td-content">{%- if requirement.statement or requirement.statement_multiline -%}{{ renderer.render_requirement_statement(requirement) }}{%- endif -%}</td>
    <td class="td-content">{%- if requirement.rationale or requirement.rationale_multiline -%}{{ renderer.render_requirement_rationale(requirement) }}{%- endif -%}</td>
    <td class="td-content">
      {%- if requirement.comments %}
      {%- for comment in requirement.comments %}
      {{ renderer.render_comment(comment) }}
      {%- endfor %}
      {%- endif %}
    </td>
  </tr>
  {%- elif section_or_requirement.is_requirement %}
    {%- set requirement = section_or_requirement %}
  <tr>
    <th>Requirement</th>
    <td>{%- if requirement.uid %}{{ requirement.uid }}{%- endif -%}</td>
    <td class="td-title">{%- if requirement.title %}{{ requirement.title }}{%- endif -%}</td>
    <td class="td-content">{%- if requirement.statement or requirement.statement_multiline -%}{{ renderer.render_requirement_statement(requirement) }}{%- endif -%}</td>
    <td class="td-content">{%- if requirement.rationale or requirement.rationale_multiline -%}{{ renderer.render_requirement_rationale(requirement) }}{%- endif -%}</td>
    <td class="td-content">
      {%- if requirement.comments %}
      {%- for comment in requirement.comments %}
      {{ renderer.render_comment(comment) }}
      {%- endfor %}
      {%- endif %}
    </td>
  </tr>
  {%- elif section_or_requirement.is_section %}

  {%- set section = section_or_requirement %}
  <tr>
   <th>Section</th>
    <td>{%- if section.uid %}{{ section.uid }}{%- endif -%}</td>
    <td class="td-title" colspan="4">{%- if section.title %}{{ section.title }}{%- endif -%}</td>
  </tr>

  {%- if section.free_texts -%}
    {%- for free_text in section.free_texts -%}
    <tr>
      <th>Free text</th>
      {# мы не будем знать, сколько здесь колонок, когла будем обходить мету #}
      <td colspan="5">
        {{ renderer.render_free_text(document_type, free_text) }}
      </td>
    </tr>
    {%- endfor -%}
  {%- endif -%}

  {%- endif %}
  {%- endfor %}

  </table>
</div>

{% endblock content %}
